tasks:
    branch: "106-wire-template-rendering"
    created: "2026-01-28"
    spec_path: "specs/106-wire-template-rendering/spec.yaml"
    plan_path: "specs/106-wire-template-rendering/plan.yaml"
summary:
    total_tasks: 14
    total_phases: 6
    parallel_opportunities: 4
    estimated_complexity: "medium"
phases:
    - number: 1
      title: "Setup"
      purpose: "Understand existing patterns and prepare test infrastructure"
      tasks:
        - id: "T001"
          title: "Review render-command CLI implementation pattern in internal/cli/util/render_command.go"
          status: "Completed"
          type: "setup"
          parallel: false
          story_id: null
          file_path: "internal/cli/util/render_command.go"
          dependencies: []
          acceptance_criteria:
            - "Understand how render-command CLI calls prereqs.ComputeContext()"
            - "Understand how render-command CLI calls commands.RenderTemplate()"
            - "Document the pattern to replicate in stage_executor.go"
    - number: 2
      title: "Foundational"
      purpose: "Add helper functions for template rendering in StageExecutor"
      tasks:
        - id: "T002"
          title: "Add getOptionsForStage() helper to internal/workflow/stage_executor.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: "internal/workflow/stage_executor.go"
          dependencies: ["T001"]
          acceptance_criteria:
            - "Function maps stage names to appropriate prereqs.Options"
            - "plan stage requires spec only"
            - "tasks stage requires spec and plan"
            - "implement stage requires spec, plan, and tasks"
            - "clarify/analyze/checklist stages require spec only"
            - "Function is under 40 lines"
        - id: "T003"
          title: "Add computeAndRenderCommand() helper to internal/workflow/stage_executor.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: "internal/workflow/stage_executor.go"
          dependencies: ["T002"]
          acceptance_criteria:
            - "Function takes command name and returns rendered template string"
            - "Function calls prereqs.ComputeContext() with stage-appropriate options"
            - "Function calls commands.GetTemplate() to get template content"
            - "Function calls commands.RenderTemplate() to render variables"
            - "Errors are wrapped with context using fmt.Errorf %w pattern"
            - "Function is under 40 lines"
    - number: 3
      title: "User Story 1 - Automated workflow execution with correct paths"
      purpose: "Wire template rendering into core workflow commands (plan, tasks, implement)"
      story_reference: "US-001"
      independent_test: "Run 'autospec run' on a feature branch and verify Claude receives rendered paths instead of {{.FeatureDir}} literals"
      tasks:
        - id: "T004"
          title: "Modify ExecutePlan() to render template before execution in internal/workflow/stage_executor.go"
          status: "Completed"
          type: "implementation"
          parallel: true
          story_id: "US-001"
          file_path: "internal/workflow/stage_executor.go"
          dependencies: ["T003"]
          acceptance_criteria:
            - "ExecutePlan() calls computeAndRenderCommand() with 'autospec.plan' command name"
            - "Rendered command passed to executor.ExecuteStage() instead of raw command"
            - "Error from rendering is propagated with context"
            - "Function remains under 40 lines"
        - id: "T005"
          title: "Modify ExecuteTasks() to render template before execution in internal/workflow/stage_executor.go"
          status: "Completed"
          type: "implementation"
          parallel: true
          story_id: "US-001"
          file_path: "internal/workflow/stage_executor.go"
          dependencies: ["T003"]
          acceptance_criteria:
            - "ExecuteTasks() calls computeAndRenderCommand() with 'autospec.tasks' command name"
            - "Rendered command passed to executor.ExecuteStage() instead of raw command"
            - "Error from rendering is propagated with context"
            - "Function remains under 40 lines"
        - id: "T006"
          title: "Modify implement-related executors to render template in internal/workflow/stage_executor.go"
          status: "Completed"
          type: "implementation"
          parallel: true
          story_id: "US-001"
          file_path: "internal/workflow/stage_executor.go"
          dependencies: ["T003"]
          acceptance_criteria:
            - "PhaseExecutor and TaskExecutor use template rendering"
            - "{{.FeatureDir}} and {{.TasksFile}} variables are rendered before Claude execution"
            - "Error from rendering is propagated with context"
            - "Functions remain under 40 lines"
    - number: 4
      title: "User Story 2 - Full pipeline execution"
      purpose: "Ensure end-to-end pipeline works without path-related failures"
      story_reference: "US-002"
      independent_test: "Run 'autospec run -pti' on a new feature and verify all stages complete without Claude searching wrong directories"
      tasks:
        - id: "T007"
          title: "Verify autospec run pipeline uses rendered templates end-to-end"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: "US-002"
          file_path: "internal/workflow/stage_executor.go"
          dependencies: ["T004", "T005", "T006"]
          acceptance_criteria:
            - "All orchestration paths (run, prep) flow through modified Execute* methods"
            - "No code paths bypass template rendering for affected stages"
            - "Verify RunOrchestrator uses StageExecutor methods consistently"
    - number: 5
      title: "User Story 3 - Auxiliary workflow commands with correct paths"
      purpose: "Wire template rendering into clarify, analyze, and checklist commands"
      story_reference: "US-003"
      independent_test: "Run 'autospec clarify' and verify it receives {{.FeatureDir}} and {{.FeatureSpec}} as actual paths"
      tasks:
        - id: "T008"
          title: "Modify ExecuteClarify() to render template in internal/workflow/stage_executor.go"
          status: "Completed"
          type: "implementation"
          parallel: true
          story_id: "US-003"
          file_path: "internal/workflow/stage_executor.go"
          dependencies: ["T003"]
          acceptance_criteria:
            - "ExecuteClarify() calls computeAndRenderCommand() with 'autospec.clarify' command name"
            - "Rendered command passed to executor.ExecuteStage() instead of raw command"
            - "Error from rendering is propagated with context"
            - "Function remains under 40 lines"
        - id: "T009"
          title: "Modify ExecuteAnalyze() to render template in internal/workflow/stage_executor.go"
          status: "Completed"
          type: "implementation"
          parallel: true
          story_id: "US-003"
          file_path: "internal/workflow/stage_executor.go"
          dependencies: ["T003"]
          acceptance_criteria:
            - "ExecuteAnalyze() calls computeAndRenderCommand() with 'autospec.analyze' command name"
            - "Rendered command passed to executor.ExecuteStage() instead of raw command"
            - "Error from rendering is propagated with context"
            - "Function remains under 40 lines"
        - id: "T010"
          title: "Modify ExecuteChecklist() to render template in internal/workflow/stage_executor.go"
          status: "Completed"
          type: "implementation"
          parallel: true
          story_id: "US-003"
          file_path: "internal/workflow/stage_executor.go"
          dependencies: ["T003"]
          acceptance_criteria:
            - "ExecuteChecklist() calls computeAndRenderCommand() with 'autospec.checklist' command name"
            - "Rendered command passed to executor.ExecuteStage() instead of raw command"
            - "Error from rendering is propagated with context"
            - "Function remains under 40 lines"
    - number: 6
      title: "Polish & Cross-Cutting Concerns"
      purpose: "Final validation, testing, and documentation"
      tasks:
        - id: "T011"
          title: "Run make test && make fmt && make lint && make build and fix any failures"
          status: "InProgress"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: "internal/workflow/stage_executor.go"
          dependencies: ["T007", "T008", "T009", "T010"]
          acceptance_criteria:
            - "make test passes with exit code 0"
            - "make fmt produces no changes"
            - "make lint passes with exit code 0"
            - "make build produces binary successfully"
        - id: "T012"
          title: "Manual testing with autospec run on feature branch"
          status: "Pending"
          type: "test"
          parallel: false
          story_id: null
          file_path: "internal/workflow/stage_executor.go"
          dependencies: ["T011"]
          acceptance_criteria:
            - "autospec plan on feature branch renders {{.FeatureDir}} correctly"
            - "autospec tasks on feature branch renders {{.ImplPlan}} correctly"
            - "autospec clarify, analyze, checklist all receive correct paths"
            - "Claude no longer sees literal {{.Variable}} patterns"
        - id: "T013"
          title: "Create manual testing plan document at .dev/tasks/106-wire-template-rendering.md"
          status: "Pending"
          type: "documentation"
          parallel: false
          story_id: null
          file_path: ".dev/tasks/106-wire-template-rendering.md"
          dependencies: ["T012"]
          acceptance_criteria:
            - "Document exists at .dev/tasks/106-wire-template-rendering.md"
            - "Contains test plan for all affected commands (plan, tasks, implement, clarify, analyze, checklist)"
            - "Includes Report Summaries section for manual testing results"
        - id: "T014"
          title: "Update changelog in internal/changelog/changelog.yaml and run make changelog-sync"
          status: "Pending"
          type: "documentation"
          parallel: false
          story_id: null
          file_path: "internal/changelog/changelog.yaml"
          dependencies: ["T013"]
          acceptance_criteria:
            - "1-3 user-facing bullets added to changelog.yaml under appropriate version"
            - "make changelog-sync regenerates CHANGELOG.md successfully"
            - "Entry describes that template variables are now rendered in workflow execution"
dependencies:
    user_story_order:
        - story_id: "US-001"
          depends_on: []
          blocks: ["US-002"]
        - story_id: "US-002"
          depends_on: ["US-001"]
          blocks: []
        - story_id: "US-003"
          depends_on: []
          blocks: []
    phase_order:
        - phase: 1
          blocks: [2]
        - phase: 2
          blocks: [3, 4, 5]
        - phase: 3
          blocks: [4]
        - phase: 4
          blocks: [6]
        - phase: 5
          blocks: [6]
parallel_execution:
    - phase: 3
      parallel_groups:
        - tasks: ["T004", "T005", "T006"]
          rationale: "All modify different Execute* methods, independent changes"
    - phase: 5
      parallel_groups:
        - tasks: ["T008", "T009", "T010"]
          rationale: "Each modifies a different auxiliary command method, no dependencies"
implementation_strategy:
    mvp_scope:
        phases: [1, 2, 3]
        description: "Setup + Foundational + Core workflow commands (plan, tasks, implement)"
        validation: "Run 'autospec plan' and verify {{.FeatureDir}} is rendered correctly"
    incremental_delivery:
        - milestone: "Foundation Ready"
          phases: [1, 2]
          deliverable: "Helper functions for template rendering available"
        - milestone: "Core Commands Working"
          phases: [1, 2, 3]
          deliverable: "plan, tasks, implement commands render templates correctly"
        - milestone: "Full Pipeline Working"
          phases: [1, 2, 3, 4]
          deliverable: "autospec run works end-to-end with correct paths"
        - milestone: "All Commands Working"
          phases: [1, 2, 3, 4, 5]
          deliverable: "All six affected commands render templates correctly"
        - milestone: "Complete"
          phases: [1, 2, 3, 4, 5, 6]
          deliverable: "All tests pass, changelog updated, manual testing documented"
_meta:
    version: "1.0.0"
    generator: "autospec"
    generator_version: "autospec 0.10.1"
    created: "2026-01-28"
    artifact_type: "tasks"
