tasks:
    branch: "049-phase-context-meta"
    created: "2025-12-18"
    spec_path: "specs/049-phase-context-meta/spec.yaml"
    plan_path: "specs/049-phase-context-meta/plan.yaml"
summary:
    total_tasks: 12
    total_phases: 5
    parallel_opportunities: 3
    estimated_complexity: "medium"
phases:
    - number: 1
      title: "Setup"
      purpose: "Verify existing codebase structure and test baseline"
      tasks:
        - id: "T001"
          title: "Verify baseline tests pass and review PhaseContext struct"
          status: "Completed"
          type: "setup"
          parallel: false
          story_id: null
          file_path: "internal/workflow/phase_context.go"
          dependencies: []
          acceptance_criteria:
            - "make test passes with current codebase"
            - "PhaseContext struct location and fields documented"
            - "Understand current YAML serialization behavior"
    - number: 2
      title: "Foundational"
      purpose: "Define ContextMeta struct and integrate into PhaseContext"
      tasks:
        - id: "T002"
          title: "Define ContextMeta struct with YAML tags in phase_context.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: "internal/workflow/phase_context.go"
          dependencies: ["T001"]
          acceptance_criteria:
            - "ContextMeta struct defined with PhaseArtifactsBundled (bool), BundledArtifacts ([]string), HasChecklists (bool), SkipReads ([]string)"
            - "YAML tags: phase_artifacts_bundled, bundled_artifacts, has_checklists, skip_reads"
            - "Struct comment documents purpose and usage"
        - id: "T003"
          title: "Add ContextMeta field to PhaseContext struct as first field"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: "internal/workflow/phase_context.go"
          dependencies: ["T002"]
          acceptance_criteria:
            - "PhaseContext struct has ContextMeta field with yaml tag '_context_meta'"
            - "ContextMeta field is FIRST in struct for YAML ordering"
            - "Existing PhaseContext fields remain unchanged"
        - id: "T004"
          title: "Add unit tests for ContextMeta YAML serialization"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: null
          file_path: "internal/workflow/phase_context_test.go"
          dependencies: ["T003"]
          acceptance_criteria:
            - "Test verifies ContextMeta serializes to YAML with correct field names"
            - "Test verifies _context_meta appears at top of PhaseContext YAML output"
            - "Test uses map-based table-driven pattern with t.Parallel()"
    - number: 3
      title: "User Story 1 - Skip redundant artifact reads"
      purpose: "Implement metadata population signaling bundled artifacts"
      story_reference: "US-001"
      independent_test: "Generate phase context, verify _context_meta section is present and contains expected fields"
      tasks:
        - id: "T005"
          title: "Implement BuildPhaseContext metadata population for bundled artifacts"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: "US-001"
          file_path: "internal/workflow/phase_context.go"
          dependencies: ["T004"]
          acceptance_criteria:
            - "BuildPhaseContext sets PhaseArtifactsBundled to true"
            - "BuildPhaseContext sets BundledArtifacts to ['spec.yaml', 'plan.yaml', 'tasks.yaml (phase-filtered)']"
            - "BuildPhaseContext populates SkipReads with actual paths (specs/<feature>/spec.yaml, etc.)"
            - "Error handling wraps any errors with context"
        - id: "T006"
          title: "Add unit tests for bundled artifacts metadata population"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: "US-001"
          file_path: "internal/workflow/phase_context_test.go"
          dependencies: ["T005"]
          acceptance_criteria:
            - "Test verifies PhaseArtifactsBundled is true in generated context"
            - "Test verifies BundledArtifacts contains expected three items"
            - "Test verifies SkipReads contains correct paths for spec directory"
            - "Test uses map-based table-driven pattern with t.Parallel()"
    - number: 4
      title: "User Story 2 - Indicate checklists directory existence"
      purpose: "Implement checklists directory detection"
      story_reference: "US-002"
      independent_test: "Generate phase context for features with and without checklists directory, verify has_checklists flag accuracy"
      tasks:
        - id: "T007"
          title: "Add helper function to check checklists directory existence"
          status: "Completed"
          type: "implementation"
          parallel: true
          story_id: "US-002"
          file_path: "internal/workflow/phase_context.go"
          dependencies: ["T004"]
          acceptance_criteria:
            - "Helper function checkChecklistsExist(specDir string) bool"
            - "Returns true only if checklists/ is a directory (not file)"
            - "Returns false if checklists/ does not exist"
            - "Performance: uses os.Stat for <1ms check"
            - "Function under 15 lines"
        - id: "T008"
          title: "Integrate checklists check into BuildPhaseContext"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: "US-002"
          file_path: "internal/workflow/phase_context.go"
          dependencies: ["T007"]
          acceptance_criteria:
            - "BuildPhaseContext calls checkChecklistsExist and sets HasChecklists"
            - "HasChecklists correctly reflects directory existence"
        - id: "T009"
          title: "Add unit tests for checklists directory detection"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: "US-002"
          file_path: "internal/workflow/phase_context_test.go"
          dependencies: ["T008"]
          acceptance_criteria:
            - "Test with no checklists directory returns false"
            - "Test with checklists directory returns true"
            - "Test with checklists as file (not directory) returns false"
            - "Test uses map-based table-driven pattern with t.Parallel()"
            - "Tests use t.TempDir() for test isolation"
    - number: 5
      title: "User Story 3 - Document context metadata usage"
      purpose: "Update implement.md template with _context_meta documentation"
      story_reference: "US-003"
      independent_test: "Read implement.md template, verify _context_meta documentation section exists"
      tasks:
        - id: "T010"
          title: "Add Phase Context Metadata section to implement.md template"
          status: "Completed"
          type: "documentation"
          parallel: true
          story_id: "US-003"
          file_path: "internal/commands/autospec.implement.md"
          dependencies: ["T005"]
          acceptance_criteria:
            - "New section titled 'Phase Context Metadata' added"
            - "Documents _context_meta.phase_artifacts_bundled meaning"
            - "Documents _context_meta.bundled_artifacts list"
            - "Documents _context_meta.has_checklists meaning"
            - "Documents _context_meta.skip_reads list"
            - "Explicit instruction: DO NOT read files listed in skip_reads"
        - id: "T011"
          title: "Run all quality gates and verify backward compatibility"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: null
          file_path: "internal/workflow/phase_context_test.go"
          dependencies: ["T009", "T010"]
          acceptance_criteria:
            - "make test passes (all existing tests still pass)"
            - "make fmt produces no changes"
            - "make lint passes with no errors"
            - "make build succeeds"
            - "Existing phase context generation works without _context_meta consumers"
        - id: "T012"
          title: "Manual verification of generated phase context files"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: null
          file_path: "specs/049-phase-context-meta/"
          dependencies: ["T011"]
          acceptance_criteria:
            - "Generate phase context for a test feature"
            - "Verify _context_meta section appears at TOP of YAML"
            - "Verify phase_artifacts_bundled is true"
            - "Verify bundled_artifacts contains three items"
            - "Verify has_checklists reflects actual directory state"
            - "Verify skip_reads contains correct paths"
dependencies:
    user_story_order:
        - story_id: "US-001"
          depends_on: []
          blocks: []
        - story_id: "US-002"
          depends_on: []
          blocks: []
        - story_id: "US-003"
          depends_on: ["US-001"]
          blocks: []
    phase_order:
        - phase: 1
          blocks: [2]
        - phase: 2
          blocks: [3, 4]
        - phase: 3
          blocks: [5]
        - phase: 4
          blocks: [5]
parallel_execution:
    - phase: 4
      parallel_groups:
        - tasks: ["T007"]
          rationale: "Checklists helper can be developed in parallel with US-001 work after foundational is complete"
    - phase: 5
      parallel_groups:
        - tasks: ["T010"]
          rationale: "Documentation can be written in parallel once implementation is understood"
implementation_strategy:
    mvp_scope:
        phases: [1, 2, 3]
        description: "Setup + Foundational + Skip redundant reads metadata"
        validation: "Generated phase context includes _context_meta with phase_artifacts_bundled and skip_reads"
    incremental_delivery:
        - milestone: "Foundation Ready"
          phases: [1, 2]
          deliverable: "ContextMeta struct defined and integrated into PhaseContext with YAML serialization working"
        - milestone: "Core Metadata Complete"
          phases: [1, 2, 3, 4]
          deliverable: "Full _context_meta population including checklists detection"
        - milestone: "Feature Complete"
          phases: [1, 2, 3, 4, 5]
          deliverable: "All metadata populated, documented, and verified"
_meta:
    version: "1.0.0"
    generator: "autospec"
    generator_version: "autospec dev"
    created: "2025-12-18T07:47:02Z"
    artifact_type: "tasks"
