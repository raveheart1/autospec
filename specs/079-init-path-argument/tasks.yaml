tasks:
    branch: "079-init-path-argument"
    created: "2026-01-02"
    spec_path: "specs/079-init-path-argument/spec.yaml"
    plan_path: "specs/079-init-path-argument/plan.yaml"
summary:
    total_tasks: 12
    total_phases: 5
    parallel_opportunities: 4
    estimated_complexity: "medium"
phases:
    - number: 1
      title: "Setup"
      purpose: "Create new path resolution module structure"
      tasks:
        - id: "T001"
          title: "Create path.go module skeleton in internal/cli/config/path.go"
          status: "Completed"
          type: "setup"
          parallel: false
          story_id: null
          file_path: "internal/cli/config/path.go"
          dependencies: []
          acceptance_criteria:
            - "File exists with package declaration and doc comment"
            - "Imports declared for os, os/user, path/filepath, fmt"
    - number: 2
      title: "Foundational - Path Resolution"
      purpose: "Core path resolution utilities that all user stories depend on"
      tasks:
        - id: "T002"
          title: "Implement ResolvePath function in internal/cli/config/path.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: "internal/cli/config/path.go"
          dependencies: ["T001"]
          acceptance_criteria:
            - "ResolvePath accepts raw path string and returns absolute path"
            - "Empty string returns current working directory"
            - "Dot (.) returns current working directory"
            - "Tilde (~) expands to user home directory"
            - "Relative paths resolved against current directory"
            - "Absolute paths returned unchanged"
            - "Errors wrapped with context per AGENTS.md"
            - "Function <40 lines per constitution principle PRIN-011"
        - id: "T003"
          title: "Implement EnsureDirectory function in internal/cli/config/path.go"
          status: "Completed"
          type: "implementation"
          parallel: true
          story_id: null
          file_path: "internal/cli/config/path.go"
          dependencies: ["T001"]
          acceptance_criteria:
            - "EnsureDirectory creates directory if it doesn't exist (MkdirAll 0755)"
            - "Returns error if path exists and is a file"
            - "Returns nil if directory already exists"
            - "Errors include clear message about path being a file vs permission denied"
            - "Function <40 lines per constitution principle PRIN-011"
        - id: "T004"
          title: "Add unit tests for path resolution in internal/cli/config/path_test.go"
          status: "Completed"
          type: "test"
          parallel: true
          story_id: null
          file_path: "internal/cli/config/path_test.go"
          dependencies: ["T001"]
          acceptance_criteria:
            - "Map-based table tests per AGENTS.md"
            - "Tests use t.Parallel() per constitution"
            - "Test cases: empty path, dot, tilde, relative path, absolute path"
            - "Test cases: path with spaces, path with special characters"
            - "Test cases: directory creation success, directory already exists"
            - "Test cases: path is file (error), permission denied (error)"
            - "All tests pass with make test"
    - number: 3
      title: "User Story 1 - Initialize project at specified path"
      purpose: "Enable users to run autospec init with a path argument to initialize at any location"
      story_reference: "US-001"
      independent_test: "Run init with a path and verify project structure is created at that location"
      tasks:
        - id: "T005"
          title: "Update init command to accept optional path argument in internal/cli/config/init_cmd.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: "US-001"
          file_path: "internal/cli/config/init_cmd.go"
          dependencies: ["T002", "T003", "T004"]
          acceptance_criteria:
            - "Command Use changed from 'init' to 'init [path]'"
            - "Args validation accepts 0 or 1 positional arguments"
            - "Path argument extracted from args[0] when provided"
            - "ResolvePath called to convert raw path to absolute"
            - "EnsureDirectory called to create directory if needed"
            - "Backward compatible: init without arguments works unchanged"
        - id: "T006"
          title: "Add init command path argument tests in internal/cli/config/init_cmd_test.go"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: "US-001"
          file_path: "internal/cli/config/init_cmd_test.go"
          dependencies: ["T005"]
          acceptance_criteria:
            - "Test init with relative path creates at resolved location"
            - "Test init with absolute path creates at exact location"
            - "Test init with non-existent path creates directory"
            - "Test init without path works in current directory (backward compat)"
            - "Test init with path that is file returns error"
            - "Map-based table tests with t.Parallel()"
    - number: 4
      title: "User Story 2 - Initialize in current directory explicitly"
      purpose: "Provide explicit '.' and '--here' flag for current directory initialization"
      story_reference: "US-002"
      independent_test: "Run init with '.' or --here and verify behavior matches init without arguments"
      tasks:
        - id: "T007"
          title: "Add --here flag to init command in internal/cli/config/init_cmd.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: "US-002"
          file_path: "internal/cli/config/init_cmd.go"
          dependencies: ["T005"]
          acceptance_criteria:
            - "--here flag defined with Bool type"
            - "Flag help text: 'Initialize in current directory (same as init .)'"
            - "--here sets target path to current directory"
            - "Path argument takes precedence over --here when both provided"
            - "'init .' and 'init --here' produce identical results"
        - id: "T008"
          title: "Add --here flag tests in internal/cli/config/init_cmd_test.go"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: "US-002"
          file_path: "internal/cli/config/init_cmd_test.go"
          dependencies: ["T007"]
          acceptance_criteria:
            - "Test --here initializes in current directory"
            - "Test '.' initializes in current directory"
            - "Test path argument overrides --here flag"
            - "Test --here and '.' produce identical behavior"
    - number: 5
      title: "User Story 3 - Constitution workflow runs in correct directory"
      purpose: "Ensure constitution workflow subprocess operates on specified path"
      story_reference: "US-003"
      independent_test: "Run init with path and verify constitution subprocess uses correct working directory"
      tasks:
        - id: "T009"
          title: "Change working directory before constitution execution in internal/cli/config/init_cmd.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: "US-003"
          file_path: "internal/cli/config/init_cmd.go"
          dependencies: ["T005", "T007"]
          acceptance_criteria:
            - "os.Chdir called with resolved path before constitution workflow"
            - "Original working directory saved before change"
            - "Original working directory restored after init completes (deferred)"
            - "Project config created at <path>/.autospec/config.yml when --project flag used"
            - "configureSelectedAgents receives correct path for agent context"
        - id: "T010"
          title: "Add working directory integration tests in internal/cli/config/init_cmd_test.go"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: "US-003"
          file_path: "internal/cli/config/init_cmd_test.go"
          dependencies: ["T009"]
          acceptance_criteria:
            - "Test constitution workflow receives correct working directory"
            - "Test original cwd is restored after init completes"
            - "Test --project flag creates config at <path>/.autospec/config.yml"
            - "Mock constitution runner used to verify directory without actual Claude call"
    - number: 6
      title: "Polish & Documentation"
      purpose: "Documentation updates and final validation"
      tasks:
        - id: "T011"
          title: "Update CLI reference documentation in docs/public/reference.md"
          status: "Completed"
          type: "documentation"
          parallel: true
          story_id: null
          file_path: "docs/public/reference.md"
          dependencies: ["T009"]
          acceptance_criteria:
            - "init command syntax updated to show [path] argument"
            - "--here flag documented with description"
            - "Examples added for: init /path, init ., init --here, init ~/project"
            - "Edge case behavior documented (tilde expansion, symlinks)"
        - id: "T012"
          title: "Final validation: make fmt && make lint && make test && make build"
          status: "Completed"
          type: "refactor"
          parallel: false
          story_id: null
          file_path: ""
          dependencies: ["T010", "T011"]
          acceptance_criteria:
            - "make fmt completes without changes"
            - "make lint passes with no errors"
            - "make test passes all tests"
            - "make build produces working binary"
            - "Manual smoke test: autospec init /tmp/test-project succeeds"
dependencies:
    user_story_order:
        - story_id: "US-001"
          depends_on: []
          blocks: ["US-002", "US-003"]
        - story_id: "US-002"
          depends_on: ["US-001"]
          blocks: []
        - story_id: "US-003"
          depends_on: ["US-001"]
          blocks: []
    phase_order:
        - phase: 1
          blocks: [2]
        - phase: 2
          blocks: [3]
        - phase: 3
          blocks: [4, 5]
        - phase: 4
          blocks: [6]
        - phase: 5
          blocks: [6]
parallel_execution:
    - phase: 2
      parallel_groups:
        - tasks: ["T002", "T003", "T004"]
          rationale: "T002 and T003 are independent functions; T004 tests can be written in parallel"
    - phase: 6
      parallel_groups:
        - tasks: ["T011"]
          rationale: "Documentation can be updated while other tasks complete"
implementation_strategy:
    mvp_scope:
        phases: [1, 2, 3]
        description: "Setup + Path Resolution + US-001 (path argument)"
        validation: "Run 'autospec init /tmp/test' and verify project created at path"
    incremental_delivery:
        - milestone: "Path Resolution Ready"
          phases: [1, 2]
          deliverable: "Reusable path resolution functions with full test coverage"
        - milestone: "Core Feature Complete"
          phases: [1, 2, 3]
          deliverable: "init with path argument working end-to-end"
        - milestone: "Full Feature Complete"
          phases: [1, 2, 3, 4, 5]
          deliverable: "All user stories implemented with --here flag and working directory handling"
        - milestone: "Release Ready"
          phases: [1, 2, 3, 4, 5, 6]
          deliverable: "Full implementation with documentation and all validation passing"
_meta:
    version: "1.0.0"
    generator: "autospec"
    generator_version: "autospec v0.7.3"
    created: "2026-01-02T19:31:06Z"
    artifact_type: "tasks"
