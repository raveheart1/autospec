tasks:
    branch: "082-init-skip-permissions-prompt"
    created: "2026-01-06"
    spec_path: "specs/082-init-skip-permissions-prompt/spec.yaml"
    plan_path: "specs/082-init-skip-permissions-prompt/plan.yaml"
summary:
    total_tasks: 9
    total_phases: 4
    parallel_opportunities: 2
    estimated_complexity: "low"
phases:
    - number: 1
      title: "Setup"
      purpose: "Verify existing infrastructure and understand current init flow"
      tasks:
        - id: "T001"
          title: "Review existing init_cmd.go prompt patterns"
          status: "Completed"
          type: "setup"
          parallel: false
          story_id: null
          file_path: "internal/cli/config/init_cmd.go"
          dependencies: []
          acceptance_criteria:
            - "Understand existing promptYesNo, promptYesNoDefaultYes, and printSectionHeader patterns"
            - "Identify insertion point after sandbox configuration"
            - "Review updateUseSubscriptionInConfig as template for config update helper"
    - number: 2
      title: "User Story 1 & 2 - Skip Permissions Prompt and Explanation"
      purpose: "Implement core prompt with clear explanation of skip_permissions implications"
      story_reference: "US-001, US-002"
      independent_test: "Run 'autospec init', select Claude agent, verify prompt appears with complete explanation"
      tasks:
        - id: "T002"
          title: "Implement promptSkipPermissions function in init_cmd.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: "US-001"
          file_path: "internal/cli/config/init_cmd.go"
          dependencies: ["T001"]
          acceptance_criteria:
            - "Function uses printSectionHeader for consistent styling"
            - "Explanation text is under 300 characters per NFR-001"
            - "Text explains autospec may fail without sufficient Claude permissions (FR-002)"
            - "Text notes skip_permissions is safer after Claude sandbox is configured (FR-004)"
            - "Text explains users with comprehensive permissions may keep it disabled (FR-005)"
            - "Shows 'autospec config toggle skip_permissions' hint (FR-003)"
            - "Uses promptYesNo (default No) for security-sensitive opt-in"
            - "Returns bool indicating user's choice"
        - id: "T003"
          title: "Implement updateSkipPermissionsInConfig helper in init_cmd.go"
          status: "Completed"
          type: "implementation"
          parallel: true
          story_id: "US-001"
          file_path: "internal/cli/config/init_cmd.go"
          dependencies: ["T001"]
          acceptance_criteria:
            - "Follows pattern of updateUseSubscriptionInConfig"
            - "Atomically updates skip_permissions field in config file"
            - "Preserves existing config formatting and comments"
            - "Handles both project and user config paths"
            - "Errors wrapped with context per NFR-004"
        - id: "T004"
          title: "Add unit tests for prompt and config update logic"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: "US-001"
          file_path: "internal/cli/config/init_test.go"
          dependencies: ["T002", "T003"]
          acceptance_criteria:
            - "Tests use map-based table-driven pattern per NFR-005"
            - "Test prompt text contains all required elements (FR-002 through FR-005)"
            - "Test config update writes correct value"
            - "Test default is false when prompt declined (FR-006)"
    - number: 3
      title: "User Story 3 - Init Flow Integration"
      purpose: "Integrate prompt into init wizard regardless of sandbox status"
      story_reference: "US-003"
      independent_test: "Run 'autospec init' with and without sandbox, verify prompt appears in both cases"
      tasks:
        - id: "T005"
          title: "Integrate promptSkipPermissions into configureSelectedAgents"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: "US-003"
          file_path: "internal/cli/config/init_cmd.go"
          dependencies: ["T002", "T003"]
          acceptance_criteria:
            - "Prompt called only when Claude agent is selected (FR-001, FR-008)"
            - "Uses containsAgent pattern for Claude detection"
            - "Placed after sandbox configuration per plan decision"
            - "Calls updateSkipPermissionsInConfig with user's choice"
            - "Config reflects user selection after init (FR-007)"
        - id: "T006"
          title: "Add integration test for Claude-specific prompt"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: "US-003"
          file_path: "internal/cli/config/init_test.go"
          dependencies: ["T005"]
          acceptance_criteria:
            - "Test verifies prompt appears when Claude selected"
            - "Test verifies prompt does NOT appear for non-Claude agents"
            - "Test verifies prompt appears regardless of sandbox status"
    - number: 4
      title: "Polish & Edge Cases"
      purpose: "Handle edge cases and verify quality gates"
      tasks:
        - id: "T007"
          title: "Handle existing skip_permissions value during re-init"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: "internal/cli/config/init_cmd.go"
          dependencies: ["T005"]
          acceptance_criteria:
            - "Show current skip_permissions value when re-running init"
            - "Allow user to change existing value"
            - "Matches edge case EC-003 from spec"
        - id: "T008"
          title: "Handle non-interactive mode gracefully"
          status: "Completed"
          type: "implementation"
          parallel: true
          story_id: null
          file_path: "internal/cli/config/init_cmd.go"
          dependencies: ["T005"]
          acceptance_criteria:
            - "Non-interactive mode uses default (false)"
            - "No prompt displayed in non-interactive mode"
            - "Config still updated with default value"
        - id: "T009"
          title: "Run quality gates and fix any issues"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: null
          file_path: null
          dependencies: ["T007", "T008"]
          acceptance_criteria:
            - "make fmt passes with no changes"
            - "make lint passes with no errors"
            - "make test passes with no failures"
            - "make build succeeds"
            - "All functions under 40 lines (NFR-003)"
dependencies:
    user_story_order:
        - story_id: "US-001"
          depends_on: []
          blocks: ["US-003"]
        - story_id: "US-002"
          depends_on: []
          blocks: []
        - story_id: "US-003"
          depends_on: ["US-001"]
          blocks: []
    phase_order:
        - phase: 1
          blocks: [2]
        - phase: 2
          blocks: [3]
        - phase: 3
          blocks: [4]
parallel_execution:
    - phase: 2
      parallel_groups:
        - tasks: ["T002", "T003"]
          rationale: "promptSkipPermissions and updateSkipPermissionsInConfig are independent functions"
    - phase: 4
      parallel_groups:
        - tasks: ["T007", "T008"]
          rationale: "Edge cases for re-init and non-interactive mode are independent"
implementation_strategy:
    mvp_scope:
        phases: [1, 2, 3]
        description: "Setup + Prompt Implementation + Init Flow Integration"
        validation: "Run 'autospec init', select Claude, verify prompt appears and config is updated"
    incremental_delivery:
        - milestone: "Prompt Function Ready"
          phases: [1, 2]
          deliverable: "promptSkipPermissions and updateSkipPermissionsInConfig functions with tests"
        - milestone: "MVP Complete"
          phases: [1, 2, 3]
          deliverable: "Full init flow integration for Claude agent"
        - milestone: "Production Ready"
          phases: [1, 2, 3, 4]
          deliverable: "Edge cases handled, all quality gates passing"
_meta:
    version: "1.0.0"
    generator: "autospec"
    generator_version: "autospec v0.8.1"
    created: "2026-01-06T03:50:27Z"
    artifact_type: "tasks"
