tasks:
    branch: "088-dag-parallel-status"
    created: "2026-01-11"
    spec_path: "specs/088-dag-parallel-status/spec.yaml"
    plan_path: "specs/088-dag-parallel-status/plan.yaml"
summary:
    total_tasks: 24
    total_phases: 7
    parallel_opportunities: 8
    estimated_complexity: "high"
phases:
    - number: 1
      title: "Setup"
      purpose: "Create new source files for parallel execution infrastructure"
      tasks:
        - id: "T001"
          title: "Create internal/dag/parallel.go with ParallelExecutor struct"
          status: "Completed"
          type: "setup"
          parallel: false
          story_id: null
          file_path: "internal/dag/parallel.go"
          dependencies: []
          acceptance_criteria:
            - "File exists with package dag declaration"
            - "ParallelExecutor struct defined with max_parallel, fail_fast, errgroup, running_specs fields"
            - "NewParallelExecutor constructor accepting Executor and parallel options"
        - id: "T002"
          title: "Create internal/dag/progress.go with progress tracking utilities"
          status: "Completed"
          type: "setup"
          parallel: true
          story_id: null
          file_path: "internal/dag/progress.go"
          dependencies: ["T001"]
          acceptance_criteria:
            - "File exists with package dag declaration"
            - "ProgressTracker struct defined with total, completed, running counts"
            - "Render method returns formatted string (e.g., '2/5 specs complete')"
        - id: "T003"
          title: "Create internal/cli/dag/status.go with status command structure"
          status: "Completed"
          type: "setup"
          parallel: true
          story_id: null
          file_path: "internal/cli/dag/status.go"
          dependencies: ["T001"]
          acceptance_criteria:
            - "File exists with package dag declaration"
            - "statusCmd Cobra command defined with 'status [run-id]' usage"
            - "Command registered with DagCmd"
    - number: 2
      title: "Foundational"
      purpose: "Core infrastructure that MUST be complete before user story implementation"
      tasks:
        - id: "T004"
          title: "Extend DAGRun state model with parallel execution fields in internal/dag/runstate.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: "internal/dag/runstate.go"
          dependencies: ["T001"]
          acceptance_criteria:
            - "DAGRun struct has MaxParallel int field with yaml tag"
            - "DAGRun struct has RunningCount int field with yaml tag"
            - "NewDAGRun accepts maxParallel parameter"
            - "Existing tests pass with new fields"
        - id: "T005"
          title: "Implement executeSpecsConcurrently method using errgroup.SetLimit in internal/dag/parallel.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: "internal/dag/parallel.go"
          dependencies: ["T004"]
          acceptance_criteria:
            - "Method uses golang.org/x/sync/errgroup with SetLimit"
            - "Respects max_parallel limit for concurrent execution"
            - "Tracks running specs with mutex-protected map"
            - "Function under 40 lines"
        - id: "T006"
          title: "Implement dependency-aware scheduling logic in internal/dag/parallel.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: "internal/dag/parallel.go"
          dependencies: ["T005"]
          acceptance_criteria:
            - "findReadySpecs returns specs with all dependencies satisfied"
            - "Newly unblocked specs queued as each spec completes"
            - "Continues until all non-blocked specs complete or fail"
            - "Function under 40 lines"
    - number: 3
      title: "User Story 1 - Run multiple specs in parallel"
      purpose: "Core capability - parallel execution is the primary value proposition of this feature"
      story_reference: "US-001"
      independent_test: "Run a DAG file with 4 independent specs using --max-parallel 2 and verify only 2 run at a time"
      tasks:
        - id: "T007"
          title: "Add --parallel flag to dag run command in internal/cli/dag/run.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: "US-001"
          file_path: "internal/cli/dag/run.go"
          dependencies: ["T006"]
          acceptance_criteria:
            - "Flag defined: --parallel for enabling concurrent execution"
            - "Flag parsed in runDagRun function"
            - "Default value is false (sequential mode)"
        - id: "T008"
          title: "Add --max-parallel N flag to dag run command in internal/cli/dag/run.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: "US-001"
          file_path: "internal/cli/dag/run.go"
          dependencies: ["T007"]
          acceptance_criteria:
            - "Flag defined: --max-parallel with int type"
            - "Default value is 4 when --parallel is specified"
            - "Validation: must be >= 1, error if <= 0"
        - id: "T009"
          title: "Integrate ParallelExecutor into dag run when --parallel is specified in internal/cli/dag/run.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: "US-001"
          file_path: "internal/cli/dag/run.go"
          dependencies: ["T008"]
          acceptance_criteria:
            - "When --parallel: create ParallelExecutor instead of Executor"
            - "Pass max_parallel value to ParallelExecutor"
            - "Sequential mode (default) uses existing Executor unchanged"
        - id: "T010"
          title: "Add unit tests for ParallelExecutor concurrency limits in internal/dag/parallel_test.go"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: "US-001"
          file_path: "internal/dag/parallel_test.go"
          dependencies: ["T009"]
          acceptance_criteria:
            - "Test verifies at most N specs run concurrently when max-parallel=N"
            - "Test verifies dependency ordering respected during parallel execution"
            - "Uses mock CommandRunner for controlled testing"
            - "Uses map-based table test pattern"
    - number: 4
      title: "User Story 2 - View unified status of DAG execution"
      purpose: "Essential for usability - without status visibility, parallel execution is unmanageable"
      story_reference: "US-002"
      independent_test: "Start a parallel DAG run and invoke dag status to verify it shows correct states for each spec"
      tasks:
        - id: "T011"
          title: "Implement status rendering with categorized output in internal/cli/dag/status.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: "US-002"
          file_path: "internal/cli/dag/status.go"
          dependencies: ["T006"]
          acceptance_criteria:
            - "Shows completed specs with checkmark and duration"
            - "Shows running specs with spinner symbol and current stage/task"
            - "Shows pending specs with circle and blocking dependencies"
            - "Shows failed specs with X symbol and error message"
            - "Each render function under 40 lines"
        - id: "T012"
          title: "Implement run-id parameter support in dag status command in internal/cli/dag/status.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: "US-002"
          file_path: "internal/cli/dag/status.go"
          dependencies: ["T011"]
          acceptance_criteria:
            - "Without run-id: shows most recent run status"
            - "With run-id: shows status for that specific run"
            - "Error message 'run not found: <run-id>' for invalid run-id"
            - "Error message 'no DAG runs found' when no runs exist"
        - id: "T013"
          title: "Add unit tests for dag status command in internal/cli/dag/status_test.go"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: "US-002"
          file_path: "internal/cli/dag/status_test.go"
          dependencies: ["T012"]
          acceptance_criteria:
            - "Test verifies correct categorization of spec states"
            - "Test verifies run-id lookup behavior"
            - "Test verifies error messages for edge cases"
            - "Uses map-based table test pattern"
    - number: 5
      title: "User Story 3 & 4 - Output multiplexing and progress tracking"
      purpose: "Critical for debugging and UX - labeled output and progress display"
      story_reference: "US-003, US-004"
      independent_test: "Run 2 specs in parallel and verify each output line is prefixed with its spec identifier"
      tasks:
        - id: "T014"
          title: "Implement real-time progress updates during parallel execution in internal/dag/progress.go"
          status: "Pending"
          type: "implementation"
          parallel: false
          story_id: "US-004"
          file_path: "internal/dag/progress.go"
          dependencies: ["T006"]
          acceptance_criteria:
            - "Progress updates as X/Y specs complete"
            - "Updates triggered when spec status changes"
            - "Thread-safe progress tracking with mutex"
            - "Function under 40 lines"
        - id: "T015"
          title: "Integrate progress display into ParallelExecutor output in internal/dag/parallel.go"
          status: "Pending"
          type: "implementation"
          parallel: false
          story_id: "US-004"
          file_path: "internal/dag/parallel.go"
          dependencies: ["T014"]
          acceptance_criteria:
            - "Progress displayed at run start and on each completion"
            - "Uses ProgressTracker for consistent formatting"
            - "Output goes to executor stdout"
        - id: "T016"
          title: "Add tests for progress tracking in internal/dag/progress_test.go"
          status: "Pending"
          type: "test"
          parallel: false
          story_id: "US-004"
          file_path: "internal/dag/progress_test.go"
          dependencies: ["T015"]
          acceptance_criteria:
            - "Test verifies progress format 'X/Y specs complete'"
            - "Test verifies thread-safe concurrent updates"
            - "Uses map-based table test pattern"
    - number: 6
      title: "User Story 5, 6 & 7 - Signal handling and failure management"
      purpose: "Essential for reliability - graceful shutdown and failure handling"
      story_reference: "US-005, US-006, US-007"
      independent_test: "Start a DAG run, send SIGINT, and verify state is saved before exit"
      tasks:
        - id: "T017"
          title: "Implement graceful SIGINT handling with state preservation in internal/dag/parallel.go"
          status: "Pending"
          type: "implementation"
          parallel: false
          story_id: "US-005"
          file_path: "internal/dag/parallel.go"
          dependencies: ["T006"]
          acceptance_criteria:
            - "Context cancellation propagates to all running specs"
            - "Waits briefly for graceful shutdown of running specs"
            - "Saves state before exit showing which completed/interrupted"
            - "State saved within 2 seconds of SIGINT"
        - id: "T018"
          title: "Implement default failure handling - continue non-dependent specs in internal/dag/parallel.go"
          status: "Pending"
          type: "implementation"
          parallel: false
          story_id: "US-006"
          file_path: "internal/dag/parallel.go"
          dependencies: ["T017"]
          acceptance_criteria:
            - "Failed spec marked as failed in state"
            - "Dependent specs marked as blocked with 'blocked by: <spec-id>'"
            - "Independent specs continue to completion"
            - "Run completes with partial success when some specs fail"
        - id: "T019"
          title: "Add --fail-fast flag to dag run command in internal/cli/dag/run.go"
          status: "Pending"
          type: "implementation"
          parallel: false
          story_id: "US-007"
          file_path: "internal/cli/dag/run.go"
          dependencies: ["T018"]
          acceptance_criteria:
            - "Flag defined: --fail-fast for stopping on first failure"
            - "When set: first failure cancels all running specs"
            - "State saved immediately on failure"
            - "Process exits with error status"
        - id: "T020"
          title: "Add tests for failure handling scenarios in internal/dag/parallel_test.go"
          status: "Pending"
          type: "test"
          parallel: false
          story_id: "US-006"
          file_path: "internal/dag/parallel_test.go"
          dependencies: ["T019"]
          acceptance_criteria:
            - "Test verifies blocked spec marking when dependency fails"
            - "Test verifies independent specs complete despite other failures"
            - "Test verifies --fail-fast cancels all running specs"
            - "Uses map-based table test pattern"
    - number: 7
      title: "Polish & Cross-Cutting Concerns"
      purpose: "Final quality, testing, and documentation"
      tasks:
        - id: "T021"
          title: "Add race condition tests using go test -race in internal/dag/parallel_test.go"
          status: "Pending"
          type: "test"
          parallel: true
          story_id: null
          file_path: "internal/dag/parallel_test.go"
          dependencies: ["T020"]
          acceptance_criteria:
            - "Tests run with -race flag without warnings"
            - "Concurrent spec completion handled without races"
            - "Progress tracking thread-safe under concurrent updates"
        - id: "T022"
          title: "Create user documentation for parallel DAG execution in docs/public/dag-parallel.md"
          status: "Pending"
          type: "documentation"
          parallel: true
          story_id: null
          file_path: "docs/public/dag-parallel.md"
          dependencies: ["T020"]
          acceptance_criteria:
            - "Documents --parallel and --max-parallel flags"
            - "Documents dag status command with examples"
            - "Documents failure handling behavior"
            - "Documents best practices for parallel spec execution"
        - id: "T023"
          title: "Add CHANGELOG entry for new parallel execution features"
          status: "Pending"
          type: "documentation"
          parallel: true
          story_id: null
          file_path: "CHANGELOG.md"
          dependencies: ["T020"]
          acceptance_criteria:
            - "Entry for dag run --parallel and --max-parallel flags"
            - "Entry for dag status command"
            - "Entry for --fail-fast flag"
        - id: "T024"
          title: "Final validation - make test && make fmt && make lint && make build"
          status: "Pending"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: null
          dependencies: ["T021", "T022", "T023"]
          acceptance_criteria:
            - "make test exits 0 with all tests passing"
            - "make fmt exits 0 with no formatting changes"
            - "make lint exits 0 with no linting errors"
            - "make build exits 0 with binary generated"
            - "go test -race passes with zero race conditions"
dependencies:
    user_story_order:
        - story_id: "US-001"
          depends_on: []
          blocks: ["US-002", "US-003", "US-004"]
        - story_id: "US-002"
          depends_on: ["US-001"]
          blocks: []
        - story_id: "US-003"
          depends_on: ["US-001"]
          blocks: []
        - story_id: "US-004"
          depends_on: ["US-001"]
          blocks: []
        - story_id: "US-005"
          depends_on: ["US-001"]
          blocks: []
        - story_id: "US-006"
          depends_on: ["US-001"]
          blocks: ["US-007"]
        - story_id: "US-007"
          depends_on: ["US-006"]
          blocks: []
    phase_order:
        - phase: 1
          blocks: [2]
        - phase: 2
          blocks: [3, 4, 5, 6]
        - phase: 3
          blocks: [7]
        - phase: 4
          blocks: [7]
        - phase: 5
          blocks: [7]
        - phase: 6
          blocks: [7]
parallel_execution:
    - phase: 1
      parallel_groups:
        - tasks: ["T002", "T003"]
          rationale: "Different files with no dependencies on each other after T001"
    - phase: 7
      parallel_groups:
        - tasks: ["T021", "T022", "T023"]
          rationale: "Independent quality/documentation tasks with no interdependencies"
implementation_strategy:
    mvp_scope:
        phases: [1, 2, 3]
        description: "Setup + Foundational + Parallel Execution Core (US-001)"
        validation: "Run a DAG with 4 specs using --max-parallel 2 and verify concurrency limit is respected"
    incremental_delivery:
        - milestone: "Foundation Ready"
          phases: [1, 2]
          deliverable: "ParallelExecutor infrastructure with errgroup integration"
        - milestone: "Parallel Execution MVP"
          phases: [1, 2, 3]
          deliverable: "dag run --parallel --max-parallel N working with controlled concurrency"
        - milestone: "Status Visibility"
          phases: [1, 2, 3, 4]
          deliverable: "dag status command showing categorized spec states"
        - milestone: "Full Feature Complete"
          phases: [1, 2, 3, 4, 5, 6]
          deliverable: "All user stories implemented with progress tracking and failure handling"
        - milestone: "Production Ready"
          phases: [1, 2, 3, 4, 5, 6, 7]
          deliverable: "Complete feature with tests, documentation, and quality gates passed"
_meta:
    version: "1.0.0"
    generator: "autospec"
    generator_version: "autospec 0.8.2"
    created: "2026-01-11T09:19:42Z"
    artifact_type: "tasks"
